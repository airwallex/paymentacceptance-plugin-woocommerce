var Airwallex=function(e){"use strict";var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function l(e,t,n,i){return new(n||(n=Promise))((function(o,l){function r(e){try{a(i.next(e))}catch(e){l(e)}}function d(e){try{a(i.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,d)}a((i=i.apply(e,t||[])).next())}))}function r(e,t){var n,i,o,l,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return l={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function d(l){return function(d){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&l[0]?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],i=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,d])}}}var d,a,u,s,c,v,p,m,f={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",qa:"checkoutui.qa.awx.im",preview:"checkoutui.preview.awx.im",dev:"localhost:3000"},h={prod:"https://pci-api.airwallex.com",demo:"https://pci-api-demo.airwallex.com",staging:"https://pci-api-staging.airwallex.com",qa:"https://pci-api-qa.airwallex.com",preview:"https://pci-api-preview.airwallex.com",dev:"http://localhost:8080"},w=function(e){return"https://"+(f[e]||"checkout.airwallex.com")},y=function(){function e(e,t){var n,i,o=this;this.domElement=null,this.gatewayUrl=e,this.options=t,this.iframe=window.document.createElement("iframe"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","true"),this.iframe.setAttribute("importance","high"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("allowpaymentrequest","true"),null===(n=this.iframe)||void 0===n||n.setAttribute("style","\n        height: 0;\n        width: 100%;\n        display: block;\n      "),i=function(e){var t,n,i;if(e.origin===o.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)){var l=new CustomEvent(null===(n=e.data)||void 0===n?void 0:n.code,{detail:{type:null===(i=e.data)||void 0===i?void 0:i.type},bubbles:!0,composed:!0});window.document.dispatchEvent(l)}},window.addEventListener("message",(function(e){window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(e.data)),i(e)}))}return e.prototype.addResizeListener=function(e){var t=this;window.addEventListener("message",(function(n){var i,o,l,r;if(n.origin===t.gatewayUrl&&n.isTrusted&&"onResize"===(null===(i=n.data)||void 0===i?void 0:i.code)&&e===(null===(o=n.data)||void 0===o?void 0:o.type)){var d=null===(l=t.iframe)||void 0===l?void 0:l.style;d&&(d.height=(null===(r=n.data)||void 0===r?void 0:r.height)+"px")}}))},e.prototype.mount=function(e){if("string"!=typeof e)return(null==e?void 0:e.hasChildNodes())&&(e.innerHTML=""),this.iframe&&e.appendChild(this.iframe),this.domElement=e,e;var t=window.document.getElementById(e);return(null==t?void 0:t.hasChildNodes())&&(t.innerHTML=""),this.iframe&&(null==t||t.appendChild(this.iframe)),t&&(this.domElement=t),t},e.prototype.blur=function(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"blur"},this.gatewayUrl)},e.prototype.clear=function(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"clear"},this.gatewayUrl)},e.prototype.destroy=function(){var e;this.clear(),null===(e=this.iframe)||void 0===e||e.remove(),this.iframe=null},e.prototype.focus=function(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"focus"},this.gatewayUrl)},e.prototype.unmount=function(){var e;this.clear(),this.iframe&&(null===(e=this.domElement)||void 0===e||e.removeChild(this.iframe))},e.prototype.update=function(e){var t,n;this.options=i(i({},this.options),e),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"update",options:e},this.gatewayUrl)},e.prototype.confirm=function(){return l(this,void 0,void 0,(function(){return r(this,(function(e){throw new Error("Confirm is not supported in ElementBase")}))}))},e.prototype.success=function(e){throw new Error("Call success with "+e.id+" is not supported in ElementBase")},e.prototype.fail=function(e){throw new Error("Call fail with "+e.code+": "+e.message+" is not supported in ElementBase")},e}(),g=function(e){function t(t,n,i){var o,l,r,d,a=e.call(this,t,i)||this;return a.confirmResponse=n,null===(o=a.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/3ds-frictionless?options="+encodeURIComponent(JSON.stringify(a.options))+"&lang="+(null===(l=ae.options)||void 0===l?void 0:l.locale)),null===(r=a.iframe)||void 0===r||r.setAttribute("name","Airwallex 3DS frictionless iframe"),null===(d=a.iframe)||void 0===d||d.setAttribute("title","Airwallex 3DS frictionless iframe"),window.addEventListener("message",(function(e){var t,n,i,o;e.origin===a.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsFrictionless"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=a.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:a.confirmResponse},a.gatewayUrl))})),a}return n(t,e),t.prototype.confirm=function(){var e,t;return l(this,void 0,void 0,(function(){return r(this,(function(n){return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),[2,null]}))}))},t}(y),b=function(e){function t(t,n,i){var o,l,r,d,a,u,s,c,v,p=e.call(this,t,i)||this;p.confirmResponse=n;var m=(null==i?void 0:i.customizeChallengeWindowSize)&&M[null==i?void 0:i.customizeChallengeWindowSize]?M[null==i?void 0:i.customizeChallengeWindowSize]:M["05"],f=(null===(o=null==i?void 0:i.style)||void 0===o?void 0:o.popupWidth)?(null===(l=null==i?void 0:i.style)||void 0===l?void 0:l.popupWidth)+"px":m[0],h=(null===(r=null==i?void 0:i.style)||void 0===r?void 0:r.popupHeight)?(null===(d=null==i?void 0:i.style)||void 0===d?void 0:d.popupHeight)+"px":m[1];return null===(a=p.iframe)||void 0===a||a.setAttribute("src",t+"/#/elements/3ds-challenge?options="+encodeURIComponent(JSON.stringify(p.options))),null===(u=p.iframe)||void 0===u||u.setAttribute("name","Airwallex 3DS challenge iframe"),null===(s=p.iframe)||void 0===s||s.setAttribute("title","Airwallex 3DS challenge iframe"),null===(c=p.iframe)||void 0===c||c.setAttribute("scrolling","yes"),null===(v=p.iframe)||void 0===v||v.setAttribute("style","\n        background: #fff;\n        width: "+f+";\n        height: "+h+";\n        position: "+((null==i?void 0:i.useDefaultStyle)?"absolute":"relative")+";\n        top: "+((null==i?void 0:i.useDefaultStyle)?"50%":"0")+";\n        left: "+((null==i?void 0:i.useDefaultStyle)?"50%":"0")+";\n        transform: "+((null==i?void 0:i.useDefaultStyle)?"translate(-50%, -50%)":"none")+";\n        border-radius: "+((null==i?void 0:i.useDefaultStyle)?"4px":"0")+";\n      "),window.addEventListener("message",(function(e){var t,n,i,o;e.origin===p.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsChallenge"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=p.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:p.confirmResponse},p.gatewayUrl))})),p}return n(t,e),t.prototype.confirm=function(){var e,t;return l(this,void 0,void 0,(function(){return r(this,(function(n){return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),[2,null]}))}))},t}(y),E="threeDsFrictionless",C="threeDsChallenge",I={resolver:null,reject:null,awaiting:!1},_=function(e){var t;null===(t=document.querySelector("#"+e))||void 0===t||t.remove(),se(e===E?E:C)},x=function(){I.awaiting=!1,I.resolver=null,I.reject=null},A=function(e){var t,n,i="data"in e?e.data:e.detail,o=["hpp","api"].includes(u),l=o?null:ce(u),r=(null==l?void 0:l.gatewayUrl)||window.location.origin;("data"in e&&e.origin===r&&e.isTrusted||o)&&(null==i?void 0:i.type)===C&&("onReady"===(null==i?void 0:i.code)&&(console.log("challengeHandler onReady",(new Date).toLocaleTimeString()),setTimeout((function(){d.style.height="100%"}),2e3)),"onChallengeSuccess"===(null==i?void 0:i.code)&&(d.style.height="0"),"onSuccess"===(null==i?void 0:i.code)&&(console.log("challengeHandler onSuccess",(new Date).toLocaleTimeString()),null===(t=I.resolver)||void 0===t||t.call(I,i),x(),_(C)),["onError","onChallengeError"].includes(null==i?void 0:i.code)&&(console.log("challengeHandler "+(null==i?void 0:i.code),(new Date).toLocaleTimeString()),null===(n=I.reject)||void 0===n||n.call(I,i.error),x(),_(C)))},S=function(e){var t;_(E),a?d=a:((d=document.createElement("div")).setAttribute("id",C),d.setAttribute("style","\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 0;\n        z-index: 1500;\n        overflow: hidden;\n        background: rgba(0, 0, 0, 0.75);\n      "),document.body.appendChild(d)),ve(C,new b(p,e,{origin:window.location.origin,style:{popupWidth:s,popupHeight:c},useDefaultStyle:null===a,customizeChallengeWindowSize:v,intent:m})),window.addEventListener("message",A),null===(t=ce(C))||void 0===t||t.mount(d)},U=function(e){var t,n,i="data"in e?e.data:e.detail,o=["hpp","api"].includes(u),l=o?null:ce(u),r=(null==l?void 0:l.gatewayUrl)||window.location.origin;("data"in e&&e.origin===r&&e.isTrusted||o)&&(null==i?void 0:i.type)===E&&(_(C),"onSuccess"===(null==i?void 0:i.code)&&(console.log("frictionlessHandler onSuccess",(new Date).toLocaleTimeString()),null===(t=I.resolver)||void 0===t||t.call(I,i),x(),_(E)),["onError","onChallengeError"].includes(null==i?void 0:i.code)&&(console.log("frictionlessHandler "+(null==i?void 0:i.code),(new Date).toLocaleTimeString()),null===(n=I.reject)||void 0===n||n.call(I,i.error),x(),_(E)),"onChallenge"===(null==i?void 0:i.code)&&(console.log("frictionlessHandler onChallenge threeDsFrictionlessType",(new Date).toLocaleTimeString()),S(i)))},j=function(e){var t,n=e.intent,i=e.gatewayUrl,o=e.cardBin,l=e.next_action,r=e.authFormContainer,d=e.componentType,s=e.challengeWindowSize;if(I.awaiting&&console.warn("Should wait previous 3ds flow finished before execute new one!"),console.log("threeDsHandler onChallenge type",(new Date).toLocaleTimeString()),a=document.getElementById(r||""),u=d,v=s,p=i,m=n,_(E),_(C),"WAITING_USER_INFO_INPUT"===(null==l?void 0:l.stage))S({type:"threeDsFrictionless",next_action:l});else{ve(E,new g(p,{code:"",type:E,cardBin:o,next_action:l},{intent:m,origin:window.location.origin}));var c=document.createElement("div");c.setAttribute("id",E),document.body.appendChild(c),window.addEventListener("message",U),null===(t=ce(E))||void 0===t||t.mount(c)}return new Promise((function(e,t){I.resolver=e,I.reject=t,I.awaiting=!0}))},R=function(e){var t=e.type,n=e.popupWidth,i=e.popupHeight,o=e.authFormContainer;s=n,c=i;var d=function(e){return l(void 0,void 0,void 0,(function(){var n,i,l,a,u,s,c,v,p,m,f,h,w;return r(this,(function(r){switch(r.label){case 0:if(n="data"in e?e.data:e.detail,l=(i="hpp"===t)?null:ce(t),a=(null==l?void 0:l.gatewayUrl)||window.location.origin,!("data"in e&&e.origin===a&&e.isTrusted||i)||(null==n?void 0:n.type)!==t||"onChallenge"!==(null==n?void 0:n.code))return[3,4];u=n.cardBin,s=n.next_action,c=n.intent,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,j({gatewayUrl:a,cardBin:u,intent:c,next_action:s,authFormContainer:o,componentType:t})];case 2:return v=r.sent(),"hpp"===t?(y=new CustomEvent("on3dsSuccess",{detail:v,bubbles:!0,composed:!0}),window.document.dispatchEvent(y)):((null==v?void 0:v.intent)&&(null==l||l.success(null==v?void 0:v.intent)),null===(f=null===(m=null==l?void 0:l.iframe)||void 0===m?void 0:m.contentWindow)||void 0===f||f.postMessage({code:"on3dsSuccess",confirmResult:v},a)),window.removeEventListener("message",d),window.removeEventListener("message",U),window.removeEventListener("message",A),[3,4];case 3:return p=r.sent(),"hpp"===t?function(e){var t=new CustomEvent("on3dsError",{detail:{error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}(p):(p&&(null==l||l.fail(p)),null===(w=null===(h=null==l?void 0:l.iframe)||void 0===h?void 0:h.contentWindow)||void 0===w||w.postMessage({code:"on3dsError",error:p},a)),window.removeEventListener("message",A),[3,4];case 4:return[2]}var y}))}))};window.addEventListener("message",d)},W="",L=function(e){var t=e.intent_id,n=void 0===t?"":t,i=e.env,o=void 0===i?"prod":i;if(!W.includes(n)){var l="prod"===o?"9ozphlqx":"45ssiuz3",r=document.createElement("script");W=""+n+Date.now(),r.src="https://h.online-metrix.net/fp/tags.js?org_id="+l+"&session_id="+W,document.body.appendChild(r)}return W},M={"01":["250px","400px"],"02":["390px","400px"],"03":["500px","600px"],"04":["600px","400px"],"05":["100%","100%"]},O="card",P=function(e){var t=e.payment_consent_id,n=e.id,i=e.customer_id,o=e.currency,l=(e.latest_payment_attempt||{}).payment_method||{},r=l.id,d=l.card||{};return{intent_id:n,payment_consent_id:t||"",customer_id:i||"",currency:o||"",payment_method:{id:r||"",bin:d.bin,last4:d.last4,brand:d.brand}}},T=function(e){function t(t,n){var o,l,r,d,a,u=e.call(this,t,n)||this;return u.confirmIntent={resolver:null,reject:null,awaiting:!1},u.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(o=u.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/card?options="+JSON.stringify(i(i({},u.options),{fonts:null===(l=ae.options)||void 0===l?void 0:l.fonts}))+"&lang="+(null===(r=ae.options)||void 0===r?void 0:r.locale)),null===(d=u.iframe)||void 0===d||d.setAttribute("name","Airwallex card element iframe"),null===(a=u.iframe)||void 0===a||a.setAttribute("title","Airwallex card element iframe"),u.addResizeListener(O),window.addEventListener("message",(function(e){var t,i,o,l,r,d,a,s,c,v,p,m,f,h,w,y,g,b,E,C,I,_,x,A,S,U;if(e.origin===u.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===O){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){var j=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:O},bubbles:!0,composed:!0});window.document.dispatchEvent(j),null===(l=u.domElement)||void 0===l||l.dispatchEvent(j)}"onDynamicCurrencyConversion"===(null===(r=e.data)||void 0===r?void 0:r.code)&&(j=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:O},bubbles:!0,composed:!0}),window.document.dispatchEvent(j),null===(a=u.domElement)||void 0===a||a.dispatchEvent(j)),"onReady"===(null===(s=e.data)||void 0===s?void 0:s.code)&&(j=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:O},bubbles:!0,composed:!0}),null===(v=u.domElement)||void 0===v||v.dispatchEvent(j),R({type:O,popupWidth:null===(p=null==n?void 0:n.style)||void 0===p?void 0:p.popupWidth,popupHeight:null===(m=null==n?void 0:n.style)||void 0===m?void 0:m.popupHeight,authFormContainer:null==n?void 0:n.authFormContainer})),"onSuccess"===(null===(f=e.data)||void 0===f?void 0:f.code)&&u.success(null===(h=e.data)||void 0===h?void 0:h.intent),"onError"===(null===(w=e.data)||void 0===w?void 0:w.code)&&u.fail(null===(y=e.data)||void 0===y?void 0:y.error),["onFocus","onBlur","onChange"].includes(null===(g=e.data)||void 0===g?void 0:g.code)&&(j=new CustomEvent(null===(b=e.data)||void 0===b?void 0:b.code,{detail:{type:O,complete:null!==(C=null===(E=e.data)||void 0===E?void 0:E.complete)&&void 0!==C&&C,empty:null!==(_=null===(I=e.data)||void 0===I?void 0:I.empty)&&void 0!==_&&_,error:null===(x=e.data)||void 0===x?void 0:x.error,brand:null!==(S=null===(A=e.data)||void 0===A?void 0:A.brand)&&void 0!==S?S:""},bubbles:!0,composed:!0}),window.document.dispatchEvent(j),null===(U=u.domElement)||void 0===U||U.dispatchEvent(j))}})),u}return n(t,e),t.prototype.confirm=function(e){var t,n,d;return l(this,void 0,void 0,(function(){var l,a,u,s,c,v=this;return r(this,(function(r){return this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!"),a=(l=e||{}).id,u=l.intent_id,s=o(l,["id","intent_id","element"]),c=L({intent_id:u||a,env:null===(t=null==ae?void 0:ae.options)||void 0===t?void 0:t.env}),null===(d=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===d||d.postMessage({code:"confirm",data:i(i({},s),{id:a||u,deviceId:c})},this.gatewayUrl),[2,new Promise((function(e,t){v.confirmIntent.resolver=e,v.confirmIntent.reject=t,v.confirmIntent.awaiting=!0}))]}))}))},t.prototype.createPaymentConsent=function(e){var t,n,d;return l(this,void 0,void 0,(function(){var l,a,u,s=this;return r(this,(function(r){return this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!"),l=e.intent_id,a=o(e,["element","intent_id"]),u=L({intent_id:l,env:null===(t=null==ae?void 0:ae.options)||void 0===t?void 0:t.env}),null===(d=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===d||d.postMessage({code:"createPaymentConsent",data:i(i({},a),{deviceId:u,intent_id:l})},this.gatewayUrl),[2,new Promise((function(e,t){s.paymentConsent.resolver=e,s.paymentConsent.reject=t,s.paymentConsent.awaiting=!0}))]}))}))},t.prototype.success=function(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(P(e)),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1},t.prototype.fail=function(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}},t}(y),D="cardNumber",F=function(e){function t(t,n){var o,l,r,d,a,u=e.call(this,t,n)||this;return u.retrieve={resolver:null,reject:null,awaiting:!1},u.confirmIntent={resolver:null,reject:null,awaiting:!1},u.createMethod={resolver:null,reject:null,awaiting:!1},u.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(o=u.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/card-number?options="+encodeURIComponent(JSON.stringify(i(i({},u.options),{fonts:null===(l=ae.options)||void 0===l?void 0:l.fonts})))+"&lang="+(null===(r=ae.options)||void 0===r?void 0:r.locale)),null===(d=u.iframe)||void 0===d||d.setAttribute("name","Airwallex card number element iframe"),null===(a=u.iframe)||void 0===a||a.setAttribute("title","Airwallex card number element iframe"),u.addResizeListener(D),window.addEventListener("message",(function(e){var t,i,o,l,r,d,a,s,c,v,p,m,f,h,w,y,g,b,E,C,I,_,x,A,S,U,j,W,L,M,O,P,T,F,z;if(e.origin===u.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===D){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){var N=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:D},bubbles:!0,composed:!0});window.document.dispatchEvent(N),null===(l=u.domElement)||void 0===l||l.dispatchEvent(N)}"onDynamicCurrencyConversion"===(null===(r=e.data)||void 0===r?void 0:r.code)&&(N=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:D},bubbles:!0,composed:!0}),window.document.dispatchEvent(N),null===(a=u.domElement)||void 0===a||a.dispatchEvent(N)),"onReady"===(null===(s=e.data)||void 0===s?void 0:s.code)&&(N=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:null===(v=e.data)||void 0===v?void 0:v.type},bubbles:!0,composed:!0}),null===(p=u.domElement)||void 0===p||p.dispatchEvent(N),R({type:D,popupWidth:null===(m=null==n?void 0:n.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(f=null==n?void 0:n.style)||void 0===f?void 0:f.popupHeight,authFormContainer:null==n?void 0:n.authFormContainer})),"onSuccess"===(null===(h=e.data)||void 0===h?void 0:h.code)&&(u.confirmIntent.resolver||u.paymentConsent.resolver)&&u.success(null===(w=e.data)||void 0===w?void 0:w.intent),"onError"===(null===(y=e.data)||void 0===y?void 0:y.code)&&(u.confirmIntent.reject||u.paymentConsent.reject)&&u.fail(null===(g=e.data)||void 0===g?void 0:g.error),"onIntentRetrieved"===(null===(b=e.data)||void 0===b?void 0:b.code)&&u.retrieve.resolver&&u.success(null===(E=e.data)||void 0===E?void 0:E.intent),"onRetrieveIntentError"===(null===(C=e.data)||void 0===C?void 0:C.code)&&(u.fail(null===(I=e.data)||void 0===I?void 0:I.error),u.retrieve.awaiting=!1),"onPaymentMethodCreated"===(null===(_=e.data)||void 0===_?void 0:_.code)&&u.createMethod.resolver&&(u.createMethod.resolver(null===(x=e.data)||void 0===x?void 0:x.paymentMethod),u.createMethod.awaiting=!1),"onPaymentMethodCreatedError"===(null===(A=e.data)||void 0===A?void 0:A.code)&&u.fail(null===(S=e.data)||void 0===S?void 0:S.error),["onFocus","onBlur","onChange"].includes(null===(U=e.data)||void 0===U?void 0:U.code)&&(N=new CustomEvent(null===(j=e.data)||void 0===j?void 0:j.code,{detail:{type:D,complete:null!==(L=null===(W=e.data)||void 0===W?void 0:W.complete)&&void 0!==L&&L,empty:null!==(O=null===(M=e.data)||void 0===M?void 0:M.empty)&&void 0!==O&&O,error:null===(P=e.data)||void 0===P?void 0:P.error,brand:null!==(F=null===(T=e.data)||void 0===T?void 0:T.brand)&&void 0!==F?F:""},bubbles:!0,composed:!0}),window.document.dispatchEvent(N),null===(z=u.domElement)||void 0===z||z.dispatchEvent(N))}})),u}return n(t,e),t.prototype.confirm=function(e){var t,n,d;return l(this,void 0,void 0,(function(){var l,a,u,s,c,v=this;return r(this,(function(r){return this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!"),a=(l=e||{}).id,u=l.intent_id,s=o(l,["id","intent_id","element"]),c=L({intent_id:u||a,env:null===(t=null==ae?void 0:ae.options)||void 0===t?void 0:t.env}),null===(d=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===d||d.postMessage({code:"confirm",data:i(i({},s),{id:a||u,deviceId:c})},this.gatewayUrl),[2,new Promise((function(e,t){v.confirmIntent.resolver=e,v.confirmIntent.reject=t,v.confirmIntent.awaiting=!0}))]}))}))},t.prototype.createPaymentMethod=function(e){var t,n;return l(this,void 0,void 0,(function(){var i,l=this;return r(this,(function(r){return this.createMethod.awaiting&&console.warn("Should waiting previous createPaymentMethod finished before execute new one!"),i=o(e||{},["element"]),null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentMethod",data:i},this.gatewayUrl),[2,new Promise((function(e,t){l.createMethod.resolver=e,l.createMethod.reject=t,l.createMethod.awaiting=!0}))]}))}))},t.prototype.createPaymentConsent=function(e){var t,n,d;return l(this,void 0,void 0,(function(){var l,a,u,s=this;return r(this,(function(r){return this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!"),l=e.intent_id,a=o(e,["element","intent_id"]),u=L({intent_id:l,env:null===(t=null==ae?void 0:ae.options)||void 0===t?void 0:t.env}),null===(d=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===d||d.postMessage({code:"createPaymentConsent",data:i(i({},a),{deviceId:u,intent_id:l})},this.gatewayUrl),[2,new Promise((function(e,t){s.paymentConsent.resolver=e,s.paymentConsent.reject=t,s.paymentConsent.awaiting=!0}))]}))}))},t.prototype.getPaymentIntent=function(e,t){var n,i;return l(this,void 0,void 0,(function(){var o=this;return r(this,(function(l){return this.retrieve.awaiting&&console.warn("Should waiting previous getPaymentIntent finished before execute new one!"),null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"getIntent",data:{id:e,client_secret:t}},this.gatewayUrl),[2,new Promise((function(e,t){o.retrieve.resolver=e,o.retrieve.reject=t,o.retrieve.awaiting=!0}))]}))}))},t.prototype.success=function(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.retrieve.awaiting&&this.retrieve.resolver&&this.retrieve.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(P(e)),this.confirmIntent.awaiting=!1,this.retrieve.awaiting=!1,this.paymentConsent.awaiting=!1},t.prototype.fail=function(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.retrieve.awaiting&&this.retrieve.reject&&this.retrieve.reject(e),this.createMethod.awaiting&&this.createMethod.reject&&this.createMethod.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}},t}(y),z="expiry",N=function(e){function t(t,n){var o,l,r,d,a,u=e.call(this,t,n)||this;return null===(o=u.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/expiry?options="+encodeURIComponent(JSON.stringify(i(i({},u.options),{fonts:null===(l=ae.options)||void 0===l?void 0:l.fonts})))+"&lang="+(null===(r=ae.options)||void 0===r?void 0:r.locale)),null===(d=u.iframe)||void 0===d||d.setAttribute("name","Airwallex expiry number element iframe"),null===(a=u.iframe)||void 0===a||a.setAttribute("title","Airwallex expiry number element iframe"),u.addResizeListener(z),window.addEventListener("message",(function(e){var t,n,i,o,l,r,d,a,s,c,v,p,m;if(e.origin===u.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===z){if("onReady"===(null===(n=e.data)||void 0===n?void 0:n.code)){var f=new CustomEvent(null===(i=e.data)||void 0===i?void 0:i.code,{detail:{type:null===(o=e.data)||void 0===o?void 0:o.type},bubbles:!0,composed:!0});null===(l=u.domElement)||void 0===l||l.dispatchEvent(f)}["onFocus","onBlur","onChange"].includes(null===(r=e.data)||void 0===r?void 0:r.code)&&(f=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:z,complete:null!==(s=null===(a=e.data)||void 0===a?void 0:a.complete)&&void 0!==s&&s,empty:null!==(v=null===(c=e.data)||void 0===c?void 0:c.empty)&&void 0!==v&&v,error:null===(p=e.data)||void 0===p?void 0:p.error},bubbles:!0,composed:!0}),window.document.dispatchEvent(f),null===(m=u.domElement)||void 0===m||m.dispatchEvent(f))}})),u}return n(t,e),t}(y),q="cvc",B=function(e){function t(t,n){var o,l,r,d,a,u=e.call(this,t,n)||this;return u.confirmIntent={resolver:null,reject:null,awaiting:!1},null===(o=u.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/cvc?options="+encodeURIComponent(JSON.stringify(i(i({},u.options),{fonts:null===(l=ae.options)||void 0===l?void 0:l.fonts})))+"&lang="+(null===(r=ae.options)||void 0===r?void 0:r.locale)),null===(d=u.iframe)||void 0===d||d.setAttribute("name","Airwallex cvc number element iframe"),null===(a=u.iframe)||void 0===a||a.setAttribute("title","Airwallex cvc number element iframe"),u.addResizeListener("cvc"),window.addEventListener("message",(function(e){var t,i,o,l,r,d,a,s,c,v,p,m,f,h,w,y,g,b,E,C,I,_,x,A,S,U,j,W,L;if(e.origin===u.gatewayUrl&&e.isTrusted&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)===q){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){var M=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:q},bubbles:!0,composed:!0});window.document.dispatchEvent(M),null===(l=u.domElement)||void 0===l||l.dispatchEvent(M)}"onDynamicCurrencyConversion"===(null===(r=e.data)||void 0===r?void 0:r.code)&&(M=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:q},bubbles:!0,composed:!0}),window.document.dispatchEvent(M),null===(a=u.domElement)||void 0===a||a.dispatchEvent(M)),"onReady"===(null===(s=e.data)||void 0===s?void 0:s.code)&&(M=new CustomEvent(null===(c=e.data)||void 0===c?void 0:c.code,{detail:{type:null===(v=e.data)||void 0===v?void 0:v.type},bubbles:!0,composed:!0}),null===(p=u.domElement)||void 0===p||p.dispatchEvent(M),R({type:q,popupWidth:null===(m=null==n?void 0:n.style)||void 0===m?void 0:m.popupWidth,popupHeight:null===(f=null==n?void 0:n.style)||void 0===f?void 0:f.popupHeight,authFormContainer:null==n?void 0:n.authFormContainer})),"onSuccess"===(null===(h=e.data)||void 0===h?void 0:h.code)&&u.confirmIntent.resolver&&u.success(null===(w=e.data)||void 0===w?void 0:w.intent),"onError"===(null===(y=e.data)||void 0===y?void 0:y.code)&&u.confirmIntent.reject&&u.fail(null===(g=e.data)||void 0===g?void 0:g.error),["onFocus","onBlur","onChange"].includes(null===(b=e.data)||void 0===b?void 0:b.code)&&(M=new CustomEvent(null===(E=e.data)||void 0===E?void 0:E.code,{detail:{type:q,complete:null!==(I=null===(C=e.data)||void 0===C?void 0:C.complete)&&void 0!==I&&I,empty:null!==(x=null===(_=e.data)||void 0===_?void 0:_.empty)&&void 0!==x&&x,error:null===(A=e.data)||void 0===A?void 0:A.error},bubbles:!0,composed:!0}),window.document.dispatchEvent(M),null===(S=u.domElement)||void 0===S||S.dispatchEvent(M))}e.origin===u.gatewayUrl&&e.isTrusted&&"cardNumber"===(null===(U=e.data)||void 0===U?void 0:U.type)&&"onChange"===(null===(j=e.data)||void 0===j?void 0:j.code)&&(null===(L=null===(W=u.iframe)||void 0===W?void 0:W.contentWindow)||void 0===L||L.postMessage({code:"update",options:{cvcLength:e.data.cvcLength}},u.gatewayUrl))})),u}return n(t,e),t.prototype.confirm=function(e){var t,n,d;return l(this,void 0,void 0,(function(){var l,a,u,s,c,v=this;return r(this,(function(r){return this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!"),a=(l=e||{}).id,u=l.intent_id,s=o(l,["id","intent_id","element"]),c=L({intent_id:u||a,env:null===(t=null==ae?void 0:ae.options)||void 0===t?void 0:t.env}),null===(d=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===d||d.postMessage({code:"confirm",data:i(i({},s),{id:a||u,deviceId:c})},this.gatewayUrl),[2,new Promise((function(e,t){v.confirmIntent.resolver=e,v.confirmIntent.reject=t,v.confirmIntent.awaiting=!0}))]}))}))},t.prototype.success=function(e){this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.confirmIntent.awaiting=!1},t.prototype.fail=function(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1}},t}(y),H=function(e){function t(t,n){var o,l,r,d,a,u,s=e.call(this,t,n)||this,c=(n||{}).intent,v=L({intent_id:null==c?void 0:c.id,env:null===(o=null==ae?void 0:ae.options)||void 0===o?void 0:o.env});return null===(l=s.iframe)||void 0===l||l.setAttribute("src",t+"/#/elements/payment-request-button?options="+encodeURIComponent(JSON.stringify(i(i({},n),{deviceId:v,fonts:null===(r=ae.options)||void 0===r?void 0:r.fonts})))+"&lang="+(null===(d=ae.options)||void 0===d?void 0:d.locale)),null===(a=s.iframe)||void 0===a||a.setAttribute("name","Airwallex payment request element iframe"),null===(u=s.iframe)||void 0===u||u.setAttribute("title","Airwallex payment request element iframe"),s.addResizeListener("paymentRequestButton"),window.addEventListener("message",(function(e){var t,i,o,l,r,d,a,u,c,v,p;if(e.origin===s.gatewayUrl&&e.isTrusted&&"paymentRequestButton"===(null===(t=e.data)||void 0===t?void 0:t.type))if("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)){R({type:"paymentRequestButton",popupWidth:null===(o=null==n?void 0:n.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==n?void 0:n.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==n?void 0:n.authFormContainer});var m=new CustomEvent(null===(r=e.data)||void 0===r?void 0:r.code,{detail:{type:null===(d=e.data)||void 0===d?void 0:d.type},bubbles:!0,composed:!0});null===(a=s.domElement)||void 0===a||a.dispatchEvent(m)}else"onSuccess"===(null===(u=e.data)||void 0===u?void 0:u.code)?s.success(null===(c=e.data)||void 0===c?void 0:c.intent):"onError"===(null===(v=e.data)||void 0===v?void 0:v.code)&&s.fail(null===(p=e.data)||void 0===p?void 0:p.error)})),s}return n(t,e),t.prototype.success=function(e){var t=new CustomEvent("onSuccess",{detail:{type:"paymentRequestButton",intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)},t.prototype.fail=function(e){var t=new CustomEvent("onError",{detail:{type:"paymentRequestButton",error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)},t}(y),k="dropIn",J=function(e){function t(t,n){var o,l,r,d,a,u,s=e.call(this,t,n)||this,c=(n||{}).intent_id,v=L({intent_id:c,env:null===(o=null==ae?void 0:ae.options)||void 0===o?void 0:o.env});return null===(l=s.iframe)||void 0===l||l.setAttribute("src",t+"/#/elements/dropin?options="+encodeURIComponent(JSON.stringify(i(i({},n),{deviceId:v,fonts:null===(r=ae.options)||void 0===r?void 0:r.fonts})))+"&lang="+(null===(d=ae.options)||void 0===d?void 0:d.locale)),null===(a=s.iframe)||void 0===a||a.setAttribute("name","Airwallex dropIn element iframe"),null===(u=s.iframe)||void 0===u||u.setAttribute("title","Airwallex dropIn element iframe"),s.addResizeListener(k),window.addEventListener("message",(function(e){var t,i,o,l,r,d,a,u,c,v,p,m,f;if(e.origin===s.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===k){if("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)){R({type:k,popupWidth:null===(o=null==n?void 0:n.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==n?void 0:n.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==n?void 0:n.authFormContainer});var h=new CustomEvent(null===(r=e.data)||void 0===r?void 0:r.code,{detail:{type:k},bubbles:!0,composed:!0});null===(d=s.domElement)||void 0===d||d.dispatchEvent(h)}if("onRedirect"===(null===(a=e.data)||void 0===a?void 0:a.code)){var w=(null!==(c=null===(u=e.data)||void 0===u?void 0:u.redirectPayload)&&void 0!==c?c:{}).redirectUrl;window.location.href=w}else"onSuccess"===(null===(v=e.data)||void 0===v?void 0:v.code)?s.success(null===(p=e.data)||void 0===p?void 0:p.intent):"onError"===(null===(m=e.data)||void 0===m?void 0:m.code)&&s.fail(null===(f=e.data)||void 0===f?void 0:f.error)}})),s}return n(t,e),t.prototype.success=function(e){var t,n=new CustomEvent("onSuccess",{detail:{type:k,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:k,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t}(y),G="fullFeaturedCard",V=function(e){function t(t,n){var o,l,r,d,a,u,s=e.call(this,t,n)||this,c=(n||{}).intent,v=L({intent_id:null==c?void 0:c.id,env:null===(o=null==ae?void 0:ae.options)||void 0===o?void 0:o.env});return null===(l=s.iframe)||void 0===l||l.setAttribute("src",t+"/#/elements/full-featured-card?options="+encodeURIComponent(JSON.stringify(i(i({},n),{deviceId:v,fonts:null===(r=ae.options)||void 0===r?void 0:r.fonts})))+"&lang="+(null===(d=ae.options)||void 0===d?void 0:d.locale)),null===(a=s.iframe)||void 0===a||a.setAttribute("name","Airwallex full featured card element iframe"),null===(u=s.iframe)||void 0===u||u.setAttribute("title","Airwallex full featured card element iframe"),s.addResizeListener(G),window.addEventListener("message",(function(e){var t,i,o,l,r,d,a,u,c,v,p;if(e.origin===s.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===G)if("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)){R({type:G,popupWidth:null===(o=null==n?void 0:n.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==n?void 0:n.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==n?void 0:n.authFormContainer});var m=new CustomEvent(null===(r=e.data)||void 0===r?void 0:r.code,{detail:{type:null===(d=e.data)||void 0===d?void 0:d.type},bubbles:!0,composed:!0});null===(a=s.domElement)||void 0===a||a.dispatchEvent(m)}else"onSuccess"===(null===(u=e.data)||void 0===u?void 0:u.code)?s.success(null===(c=e.data)||void 0===c?void 0:c.intent):"onError"===(null===(v=e.data)||void 0===v?void 0:v.code)&&s.fail(null===(p=e.data)||void 0===p?void 0:p.error)})),s}return n(t,e),t.prototype.update=function(e){var t,n,o;this.options=i(i({},this.options),e);var l=(this.options||{}).intent,r=L({intent_id:null==l?void 0:l.id,env:null===(t=null==ae?void 0:ae.options)||void 0===t?void 0:t.env});null===(o=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===o||o.postMessage({code:"update",options:i(i({},e),{deviceId:r})},this.gatewayUrl)},t.prototype.success=function(e){var t,n=new CustomEvent("onSuccess",{detail:{type:G,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:G,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t}(y),Z="wechat",K=function(e){function t(t,n){var o,l,r,d,a,u=e.call(this,t,n)||this;return null===(o=u.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/wechat?options="+encodeURIComponent(JSON.stringify(i(i({},u.options),{fonts:null===(l=ae.options)||void 0===l?void 0:l.fonts})))+"&lang="+(null===(r=ae.options)||void 0===r?void 0:r.locale)),null===(d=u.iframe)||void 0===d||d.setAttribute("name","Airwallex wechat element iframe"),null===(a=u.iframe)||void 0===a||a.setAttribute("title","Airwallex wechat element iframe"),u.addResizeListener(Z),window.addEventListener("message",(function(e){var t,n,i,o,l,r;e.origin===u.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===Z&&("onRedirect"===(null===(n=e.data)||void 0===n?void 0:n.code)?window.location.href=null===(i=e.data)||void 0===i?void 0:i.redirectUrl:"onSuccess"===(null===(o=e.data)||void 0===o?void 0:o.code)?u.success(null===(l=e.data)||void 0===l?void 0:l.intent):"onError"===(null===(r=e.data)||void 0===r?void 0:r.code)&&u.fail(e.data.error))})),u}return n(t,e),t.prototype.success=function(e){var t,n=new CustomEvent("onSuccess",{detail:{type:Z,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:Z,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t}(y),Q="qrcode",X=function(e){function t(t,n){var o,l,r,d,a,u=e.call(this,t,n)||this;return null===(o=u.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/qrcode?options="+encodeURIComponent(JSON.stringify(i(i({},u.options),{fonts:null===(l=ae.options)||void 0===l?void 0:l.fonts})))+"&lang="+(null===(r=ae.options)||void 0===r?void 0:r.locale)),null===(d=u.iframe)||void 0===d||d.setAttribute("name","Airwallex qrcode element iframe"),null===(a=u.iframe)||void 0===a||a.setAttribute("title","Airwallex qrcode element iframe"),u.addResizeListener(Q),window.addEventListener("message",(function(e){var t,n,i,o,l,r;if(e.origin===u.gatewayUrl&&e.isTrusted&&(null===(t=e.data)||void 0===t?void 0:t.type)===Q)if("onSuccess"===(null===(n=e.data)||void 0===n?void 0:n.code))u.success(null===(i=e.data)||void 0===i?void 0:i.intent);else if("onError"===(null===(o=e.data)||void 0===o?void 0:o.code))u.fail(e.data.error);else if("onRedirect"===(null===(l=e.data)||void 0===l?void 0:l.code)){var d=null===(r=e.data)||void 0===r?void 0:r.redirectUrl;window.location.href=d}})),u}return n(t,e),t.prototype.success=function(e){var t,n=new CustomEvent("onSuccess",{detail:{type:Q,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:Q,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(n),null===(t=this.domElement)||void 0===t||t.dispatchEvent(n)},t}(y),Y=function(e){function t(t,n){var o,l,r,d,a,u=e.call(this,t,n)||this;return null===(o=u.iframe)||void 0===o||o.setAttribute("src",t+"/#/elements/redirect?options="+encodeURIComponent(JSON.stringify(i(i({},u.options),{fonts:null===(l=ae.options)||void 0===l?void 0:l.fonts})))+"&lang="+(null===(r=ae.options)||void 0===r?void 0:r.locale)),null===(d=u.iframe)||void 0===d||d.setAttribute("name","Airwallex redirect element iframe"),null===(a=u.iframe)||void 0===a||a.setAttribute("title","Airwallex redirect element iframe"),u.addResizeListener("redirect"),window.addEventListener("message",(function(e){var t,i,o,l,r;if(e.origin===u.gatewayUrl&&e.isTrusted&&"redirect"===(null===(t=e.data)||void 0===t?void 0:t.type))if("onRedirect"===(null===(i=e.data)||void 0===i?void 0:i.code)){var d=null!==(l=null===(o=e.data)||void 0===o?void 0:o.redirectPayload)&&void 0!==l?l:{},a=d.redirectUrl,s=d.method,c=d.formData;s===(null==n?void 0:n.method)&&(c?function(e,t){var n=document.createElement("form");n.setAttribute("method","post"),n.setAttribute("style","height: 0; overflow: hidden;"),n.action=t,Object.keys(e||{}).forEach((function(t){var i=document.createElement("input");i.type="hidden",i.name=t,i.value=e[t],n.appendChild(i)}));var i=document.createElement("input");i.type="submit",n.appendChild(i),document.body.appendChild(n),i.click()}(c,a):window.location.href=a)}else"onError"===(null===(r=e.data)||void 0===r?void 0:r.code)&&u.fail(e.data.error)})),u}return n(t,e),t.prototype.fail=function(e){var t,n=new CustomEvent("onError",{detail:{type:"redirect",error:e},bubbles:!0,composed:!0});null===(t=this.domElement)||void 0===t||t.dispatchEvent(n),window.document.dispatchEvent(n)},t}(y),$=function(e){return e.startsWith("http://")||e.startsWith("https://")?encodeURIComponent(e):encodeURIComponent("https://"+e)},ee=/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/,te=function(e){return"string"==typeof e},ne=function(e){return"boolean"==typeof e},ie=function(e){return"string"==typeof e&&ee.test(e)},oe=function(e){return"object"==typeof e&&null!==e},le={intent_id:{validate:te,format:function(e){return""+e}},client_secret:{validate:te,format:function(e){return""+e}},theme:{validate:oe,format:function(e){return JSON.stringify(e)}},customer_id:{validate:te,format:function(e){return""+e}},components:{validate:oe,format:function(e){return JSON.stringify(e)}},autoCapture:{validate:ne,format:function(e){return""+e}},successUrl:{validate:ie,format:function(e){return $(""+e)}},failUrl:{validate:ie,format:function(e){return $(""+e)}},cancelUrl:{validate:ie,format:function(e){return $(""+e)}},logoUrl:{validate:ie,format:function(e){return $(""+e)}},locale:{validate:te,format:function(e){return""+e}},withBilling:{validate:ne,format:function(e){return""+e}},mode:{validate:te,format:function(e){return""+e}},recurringOptions:{validate:oe,format:function(e){return encodeURIComponent(JSON.stringify(e))}},currency:{validate:te,format:function(e){return""+e}},country_code:{validate:te,format:function(e){return""+e}},shopper_name:{validate:te,format:function(e){return""+e}},shopper_phone:{validate:te,format:function(e){return""+e}},shopper_email:{validate:te,format:function(e){return""+e}}},re=["cardNumber","expiry","cvc","paymentRequestButton","card","wechat","qrcode","redirect","dropIn","fullFeaturedCard"],de=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var l=arguments[t],r=0,d=l.length;r<d;r++,o++)i[o]=l[r];return i}(re,["threeDsFrictionless","threeDsChallenge"]),ae={gatewayUrl:"",options:{}},ue={cardNumber:null,expiry:null,cvc:null,threeDsFrictionless:null,threeDsChallenge:null,paymentRequestButton:null,card:null,wechat:null,qrcode:null,redirect:null,dropIn:null,fullFeaturedCard:null},se=function(e){var t;return de.includes(e)?(null===(t=ue[e])||void 0===t||t.destroy(),ue[e]=null,!0):(console.warn("destroyElement with type: "+e+" not support!"),!1)},ce=function(e){return de.includes(e)?ue[e]:(console.warn("getElement with type: "+e+" not support!"),null)},ve=function(e,t){return de.includes(e)?(ue[e]=t,!0):(console.warn("destroyElement with type: "+e+" not support!"),!1)};return e.confirmPaymentIntent=function(e){return l(void 0,void 0,void 0,(function(){return r(this,(function(t){return console.info("Confirm intent "+((null==e?void 0:e.intent_id)||(null==e?void 0:e.id))+" with client secret: "+(null==e?void 0:e.client_secret)),(null==e?void 0:e.element)?[2,(null==e?void 0:e.element).confirm(e)]:(console.warn("Card number element must be provided for card payment confirm!"),[2,!1])}))}))},e.confirmPaymentIntentWithSavedCard=function(e){return l(void 0,void 0,void 0,(function(){return r(this,(function(t){return console.info("Confirm intent "+((null==e?void 0:e.intent_id)||(null==e?void 0:e.id))+" with client secret: "+(null==e?void 0:e.client_secret)),(null==e?void 0:e.element)&&(null==e?void 0:e.methodId)?[2,(null==e?void 0:e.element).confirm(e)]:(console.warn("Payment method id must be provided for cvc payment confirm!"),[2,!1])}))}))},e.createElement=function(e,t){var n,i=null!=t?t:{origin:""};return i.origin||(i.origin=null===(n=ae.options)||void 0===n?void 0:n.origin),re.includes(e)?"cardNumber"===e?(ue[e]=new F(ae.gatewayUrl,i),ue[e]):"card"===e?(ue[e]=new T(ae.gatewayUrl,i),ue[e]):"fullFeaturedCard"===e?(ue[e]=new V(ae.gatewayUrl,i),ue[e]):"wechat"===e?(ue[e]=new K(ae.gatewayUrl,i),ue[e]):"qrcode"===e?(ue[e]=new X(ae.gatewayUrl,i),ue[e]):"redirect"===e?(ue[e]=new Y(ae.gatewayUrl,i),ue[e]):"paymentRequestButton"===e?(ue[e]=new H(ae.gatewayUrl,i),ue[e]):"dropIn"===e?(ue[e]=new J(ae.gatewayUrl,i),ue[e]):"expiry"===e||"cvc"===e?(ue[e]="expiry"===e?new N(ae.gatewayUrl,i):new B(ae.gatewayUrl,i),window.addEventListener("message",(function(t){var n,i,o,l,r,d;t.origin===ae.gatewayUrl&&t.isTrusted&&e===(null===(n=t.data)||void 0===n?void 0:n.type)&&"onChange"===(null===(i=t.data)||void 0===i?void 0:i.code)&&(null===(r=null===(l=null===(o=ue.cardNumber)||void 0===o?void 0:o.iframe)||void 0===l?void 0:l.contentWindow)||void 0===r||r.postMessage({code:"update_"+(null===(d=t.data)||void 0===d?void 0:d.type),data:t.data},ae.gatewayUrl))})),ue[e]):null:(console.warn("createElement with type: "+e+" not support!"),null)},e.createPaymentConsent=function(e){return l(void 0,void 0,void 0,(function(){return r(this,(function(t){return console.info("Create payment consent with client secret: "+e.client_secret),(null==e?void 0:e.element)?[2,(null==e?void 0:e.element).createPaymentConsent(e)]:(console.warn("Either payment method id or element must be provided for create payment consent!"),[2,!1])}))}))},e.createPaymentMethod=function(e,t){return l(void 0,void 0,void 0,(function(){return r(this,(function(n){return console.info("Create payment method with client secret: "+e),(null==t?void 0:t.element)?[2,(null==t?void 0:t.element).createPaymentMethod(i(i({},t),{client_secret:e}))]:(console.warn("Either payment method id or element must be provided for payment method create!"),[2,!1])}))}))},e.destroyElement=se,e.get3dsReturnUrl=function(e){var t=e.env,n=e.checkoutOrigin;return h[t||"prod"]+"/api/v1/checkout/elements/3ds?origin=https://"+f[t||"prod"]+"&checkoutOrigin="+(n||window.location.origin)},e.getBrowserInfo=function(e){var t,n=window||{},i=n.navigator,o=n.screen,l=(i||{}).language,r=o||{},d=r.colorDepth,a=r.height,u=r.width,s=e||{},c=s.intent_id,v=s.env;return e&&(t=L({intent_id:c,env:v})),{device_id:t,screen_height:a,screen_width:u,screen_color_depth:d,language:l,timezone:(new Date).getTimezoneOffset(),browser:{java_enabled:window.navigator.javaEnabled(),javascript_enabled:!0,user_agent:i.userAgent}}},e.getDeviceFingerprint=L,e.getElement=ce,e.getPaymentIntent=function(e,t){return l(void 0,void 0,void 0,(function(){var n;return r(this,(function(i){return[2,(null===(n=ue.cardNumber)||void 0===n?void 0:n.getPaymentIntent(e,t))||!1]}))}))},e.handle3ds=function(e){var t=e.cardBin,n=e.next_action,i=e.authFormContainer,o=e.intent,l=e.challengeWindowSize,r=e.env;return j({gatewayUrl:"https://"+f[r],cardBin:t,intent:o,next_action:n,authFormContainer:i,componentType:"api",challengeWindowSize:l})},e.handle3dsFlow=R,e.init=function(e){!(null==e?void 0:e.env)&&ae.gatewayUrl||(ae.gatewayUrl=w((null==e?void 0:e.env)||"prod")),ae.options=e},e.redirectToCheckout=function(e){var t=e.env,n=function(e){var t={};return Object.keys(le).forEach((function(n){var i=e[n];null!==i&&""!==i&&le[n].validate(i)&&(t[n]=le[n].format(i))})),t}(o(e,["env"]))||{},i=n.id,l=o(n,["id"]),r=Object.keys(l),d=[];r.forEach((function(e){d.push(e+"="+l[e])})),d.push("from="+window.location.origin);var a="recurring"===e.mode?w(t||"prod")+"/#/standalone/recurring?"+d.join("&"):w(t||"prod")+"/#/standalone/checkout/"+(i||(null==l?void 0:l.intent_id))+"?"+d.join("&");window.location.href=a},Object.defineProperty(e,"__esModule",{value:!0}),e}({});