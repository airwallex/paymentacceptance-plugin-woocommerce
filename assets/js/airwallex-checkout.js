/* Airwallex Checkout Component Version [0.2.15] */
var Airwallex=function(e){"use strict";let t="";const n=({id:e="",env:n="prod"})=>{if(!t){const i="prod"===n?"9ozphlqx":"45ssiuz3",o=document.createElement("script");t=`${e}${Date.now()}`,o.src=`https://h.online-metrix.net/fp/tags.js?org_id=${i}&session_id=${t}`,document.body.appendChild(o)}return t};class i{constructor(e,t){var n,i;this.domElement="",this.gatewayUrl=e,this.options=t,this.iframe=window.document.createElement("iframe"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","true"),this.iframe.setAttribute("importance","high"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("allowpaymentrequest","true"),null===(n=this.iframe)||void 0===n||n.setAttribute("style","\n        height: 0;\n        width: 100%;\n        display: block;\n      "),i=e=>{var t,n,i;if(e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)){const t=new CustomEvent(null===(n=e.data)||void 0===n?void 0:n.code,{detail:{type:null===(i=e.data)||void 0===i?void 0:i.type},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}},window.addEventListener("message",(e=>{window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(e.data)),i(e)}))}addResizeListener(e){window.addEventListener("message",(t=>{var n,i,o,l;if(t.origin===this.gatewayUrl&&t.isTrusted&&"onResize"===(null===(n=t.data)||void 0===n?void 0:n.code)&&e===(null===(i=t.data)||void 0===i?void 0:i.type)){const e=null===(o=this.iframe)||void 0===o?void 0:o.style;e&&(e.height=`${null===(l=t.data)||void 0===l?void 0:l.height}px`)}}))}mount(e){if(this.domElement=e,"string"!=typeof e)(null==e?void 0:e.hasChildNodes())&&(e.innerHTML=""),this.iframe&&e.appendChild(this.iframe);else{const t=window.document.getElementById(e);(null==t?void 0:t.hasChildNodes())&&(t.innerHTML=""),this.iframe&&(null==t||t.appendChild(this.iframe))}}blur(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"blur"},this.gatewayUrl)}clear(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"clear"},this.gatewayUrl)}destroy(){var e;this.clear(),null===(e=this.iframe)||void 0===e||e.remove(),this.iframe=null}focus(){var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"focus"},this.gatewayUrl)}unmount(){var e;this.clear(),"string"!=typeof this.domElement?this.iframe&&this.domElement.removeChild(this.iframe):this.iframe&&(null===(e=window.document.getElementById(this.domElement))||void 0===e||e.removeChild(this.iframe))}update(e){var t,n;this.options={...this.options,...e},null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"update",options:e},this.gatewayUrl)}async confirm(){throw new Error("Confirm is not supported in ElementBase")}success(e){throw new Error(`Call success with ${e.id} is not supported in ElementBase`)}fail(e){throw new Error(`Call fail with ${e.code}: ${e.message} is not supported in ElementBase`)}}class o extends i{constructor(e,t,n){var i,o,l,d;super(e,n),this.confirmResponse=t,null===(i=this.iframe)||void 0===i||i.setAttribute("src",`${e}/#/elements/3ds-frictionless?options=${encodeURIComponent(JSON.stringify(this.options))}&lang=${null===(o=L.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex 3DS frictionless iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex 3DS frictionless iframe"),window.addEventListener("message",(e=>{var t,n,i,o;e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsFrictionless"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:this.confirmResponse},this.gatewayUrl))}))}async confirm(){var e,t;return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),null}}class l extends i{constructor(e,t,n){var i,o,l,d,a,r,s,u;super(e,n),this.confirmResponse=t;const c="2"===((null===(o=null===(i=null==t?void 0:t.next_action)||void 0===i?void 0:i.data)||void 0===o?void 0:o.version)||"").split(".")[0],v=null===(l=null==n?void 0:n.style)||void 0===l?void 0:l.popupHeight,m=v?`${v}px`:c?"600px":"100%",h=null===(d=null==n?void 0:n.style)||void 0===d?void 0:d.popupWidth,p=h?`${h}px`:c?"400px":"100%";null===(a=this.iframe)||void 0===a||a.setAttribute("src",`${e}/#/elements/3ds-challenge?options=${encodeURIComponent(JSON.stringify(this.options))}`),null===(r=this.iframe)||void 0===r||r.setAttribute("name","Airwallex 3DS challenge iframe"),null===(s=this.iframe)||void 0===s||s.setAttribute("title","Airwallex 3DS challenge iframe"),null===(u=this.iframe)||void 0===u||u.setAttribute("style",`\n        background: #fff;\n        height: ${m};\n        width: ${p};\n        position: ${(null==n?void 0:n.useDefaultStyle)?"absolute":"relative"};\n        top: ${(null==n?void 0:n.useDefaultStyle)?"50%":"0"};\n        left: ${(null==n?void 0:n.useDefaultStyle)?"50%":"0"};\n        transform: ${(null==n?void 0:n.useDefaultStyle)?"translate(-50%, -50%)":"none"};\n        border-radius: ${(null==n?void 0:n.useDefaultStyle)?"4px":"0"};\n      `),window.addEventListener("message",(e=>{var t,n,i,o;e.origin===this.gatewayUrl&&e.isTrusted&&"onReady"===(null===(t=e.data)||void 0===t?void 0:t.code)&&"threeDsChallenge"===(null===(n=e.data)||void 0===n?void 0:n.type)&&(null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",data:this.confirmResponse},this.gatewayUrl))}))}async confirm(){var e,t;return null===(t=null===(e=this.iframe)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({code:"confirm",data:this.confirmResponse},this.gatewayUrl),null}}const d="threeDsFrictionless",a="threeDsChallenge",r=e=>{var t;null===(t=document.querySelector(`#${e}`))||void 0===t||t.remove(),_(e===d?d:a)},s=({type:e,popupWidth:t,popupHeight:n,authFormContainer:i})=>{let s;const u=({element:t,error:n,gatewayUrl:i})=>{var o,l;"hpp"===e?(e=>{const t=new CustomEvent("on3dsError",{detail:{error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(n):(n&&(null==t||t.fail(n)),null===(l=null===(o=null==t?void 0:t.iframe)||void 0===o?void 0:o.contentWindow)||void 0===l||l.postMessage({code:"on3dsError",error:n},i)),window.removeEventListener("message",m)},c=({element:t,data:n,gatewayUrl:i})=>{var o,l;"hpp"===e?(e=>{const t=new CustomEvent("on3dsSuccess",{detail:e,bubbles:!0,composed:!0});window.document.dispatchEvent(t)})(n):((null==n?void 0:n.intent)&&(null==t||t.success(null==n?void 0:n.intent)),null===(l=null===(o=null==t?void 0:t.iframe)||void 0===o?void 0:o.contentWindow)||void 0===l||l.postMessage({code:"on3dsSuccess",confirmResult:n},i)),window.removeEventListener("message",v),window.removeEventListener("message",m)},v=v=>{var h,p;const w="data"in v?v.data:v.detail,f="hpp"===e,y=f?null:P(e),g=(null==y?void 0:y.gatewayUrl)||window.location.origin,b="data"in v&&v.origin===g&&v.isTrusted||f;if(b&&(null==w?void 0:w.type)===e&&"onChallenge"===(null==w?void 0:w.code)){console.log("frictionlessHandler onChallenge type",(new Date).toLocaleTimeString()),r(d),D(d,new o(g,w,{origin:window.location.origin}));const e=document.createElement("div");e.setAttribute("id",d),document.body.appendChild(e),null===(h=P(d))||void 0===h||h.mount(e)}if(b&&(null==w?void 0:w.type)===d){r(a);const{error:e}=w;if("onSuccess"===(null==w?void 0:w.code)&&(console.log("frictionlessHandler onSuccess",(new Date).toLocaleTimeString()),c({element:y,gatewayUrl:g,data:w}),r(d)),"onError"===(null==w?void 0:w.code)&&(console.log("frictionlessHandler onError",(new Date).toLocaleTimeString()),r(d),u({element:y,error:e,gatewayUrl:g})),"onChallengeError"===(null==w?void 0:w.code)&&(console.log("frictionlessHandler onChallengeError",(new Date).toLocaleTimeString()),r(d),u({element:y,error:e,gatewayUrl:g})),"onChallenge"===(null==w?void 0:w.code)){console.log("frictionlessHandler onChallenge threeDsFrictionlessType",(new Date).toLocaleTimeString()),r(d);const e=document.getElementById(i||"");e?s=e:(s=document.createElement("div"),s.setAttribute("id",a),s.setAttribute("style","\n              position: fixed;\n              top: 0;\n              left: 0;\n              width: 100%;\n              height: 0;\n              z-index: 1500;\n              overflow: hidden;\n              background: rgba(0, 0, 0, 0.75);\n            "),document.body.appendChild(s)),D(a,new l(g,w,{origin:window.location.origin,style:{popupWidth:t,popupHeight:n},useDefaultStyle:null===e})),window.addEventListener("message",m),null===(p=P(a))||void 0===p||p.mount(s)}}},m=t=>{const n="data"in t?t.data:t.detail,i="hpp"===e,o=i?null:P(e),l=(null==o?void 0:o.gatewayUrl)||window.location.origin;if(("data"in t&&t.origin===l&&t.isTrusted||i)&&(null==n?void 0:n.type)===a){const{error:e}=n;"onReady"===(null==n?void 0:n.code)&&(console.log("challengeHandler onReady",(new Date).toLocaleTimeString()),setTimeout((()=>{s.style.height="100%"}),2e3)),"onChallengeSuccess"===(null==n?void 0:n.code)&&(s.style.height="0"),"onSuccess"===(null==n?void 0:n.code)&&(console.log("challengeHandler onSuccess",(new Date).toLocaleTimeString()),c({element:o,gatewayUrl:l,data:n}),r(a)),"onError"===(null==n?void 0:n.code)&&(console.log("challengeHandler onError",(new Date).toLocaleTimeString()),r(a),u({element:o,error:e,gatewayUrl:l})),"onChallengeError"===(null==n?void 0:n.code)&&(r(a),u({element:o,error:e,gatewayUrl:l}))}};window.addEventListener("message",v)},u="card",c=e=>{const{payment_consent_id:t,id:n,customer_id:i,currency:o,latest_payment_attempt:l}=e,{payment_method:d}=l||{},{id:a,card:r}=d||{},{bin:s,last4:u,brand:c}=r||{};return{intent_id:n,payment_consent_id:t||"",customer_id:i||"",currency:o||"",payment_method:{id:a||"",bin:s,last4:u,brand:c}}};class v extends i{constructor(e,t){var n,i,o,l,d;super(e,t),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/card?options=${JSON.stringify({...this.options,fonts:null===(i=L.options)||void 0===i?void 0:i.fonts})}&lang=${null===(o=L.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex card element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex card element iframe"),this.addResizeListener(u),window.addEventListener("message",(e=>{var n,i,o,l,d,a,r,c,v,m,h,p,w,f,y,g,b,C,E,I,$;if(e.origin===this.gatewayUrl&&e.isTrusted&&(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.type)===u){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:u},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}if("onDynamicCurrencyConversion"===(null===(l=e.data)||void 0===l?void 0:l.code)){const t=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:u},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}if("onReady"===(null===(a=e.data)||void 0===a?void 0:a.code)&&s({type:u,popupWidth:null===(r=null==t?void 0:t.style)||void 0===r?void 0:r.popupWidth,popupHeight:null===(c=null==t?void 0:t.style)||void 0===c?void 0:c.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer}),"onSuccess"===(null===(v=e.data)||void 0===v?void 0:v.code)&&this.success(null===(m=e.data)||void 0===m?void 0:m.intent),"onError"===(null===(h=e.data)||void 0===h?void 0:h.code)&&this.fail(null===(p=e.data)||void 0===p?void 0:p.error),["onFocus","onBlur","onChange"].includes(null===(w=e.data)||void 0===w?void 0:w.code)){const t=new CustomEvent(null===(f=e.data)||void 0===f?void 0:f.code,{detail:{type:u,complete:null!==(g=null===(y=e.data)||void 0===y?void 0:y.complete)&&void 0!==g&&g,empty:null!==(C=null===(b=e.data)||void 0===b?void 0:b.empty)&&void 0!==C&&C,error:null===(E=e.data)||void 0===E?void 0:E.error,brand:null!==($=null===(I=e.data)||void 0===I?void 0:I.brand)&&void 0!==$?$:""},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}}))}async confirm(e){var t,i,o;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:l,intent_id:d,element:a,...r}=e||{},s=n({id:l,env:null===(t=null==L?void 0:L.options)||void 0===t?void 0:t.env});return null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"confirm",data:{...r,id:l||d,deviceId:s}},this.gatewayUrl),new Promise(((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0}))}async createPaymentConsent(e){var t,i,o;this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!");const{element:l,intent_id:d,...a}=e,r=n({id:d,env:null===(t=null==L?void 0:L.options)||void 0===t?void 0:t.env});return null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"createPaymentConsent",data:{...a,deviceId:r,intent_id:d}},this.gatewayUrl),new Promise(((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0}))}success(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(c(e)),this.confirmIntent.awaiting=!1,this.paymentConsent.awaiting=!1}fail(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}}}class m extends i{constructor(e,t){var n,i,o,l,d;super(e,t),this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1},null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/card-number?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=L.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=L.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex card number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex card number element iframe"),this.addResizeListener("cardNumber"),window.addEventListener("message",(e=>{var n,i,o,l,d,a,r,u,c,v,m,h,p,w,f,y,g,b,C,E,I,$,U,x,A,S,R,j,M;if(e.origin===this.gatewayUrl&&e.isTrusted&&"cardNumber"===(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.type)){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:"cardNumber"},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}if("onDynamicCurrencyConversion"===(null===(l=e.data)||void 0===l?void 0:l.code)){const t=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:"cardNumber"},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}if("onReady"===(null===(a=e.data)||void 0===a?void 0:a.code)&&s({type:"cardNumber",popupWidth:null===(r=null==t?void 0:t.style)||void 0===r?void 0:r.popupWidth,popupHeight:null===(u=null==t?void 0:t.style)||void 0===u?void 0:u.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer}),"onSuccess"===(null===(c=e.data)||void 0===c?void 0:c.code)&&(this.confirmIntent.resolver||this.paymentConsent.resolver)&&this.success(null===(v=e.data)||void 0===v?void 0:v.intent),"onError"===(null===(m=e.data)||void 0===m?void 0:m.code)&&(this.confirmIntent.reject||this.paymentConsent.reject)&&this.fail(null===(h=e.data)||void 0===h?void 0:h.error),"onIntentRetrieved"===(null===(p=e.data)||void 0===p?void 0:p.code)&&this.retrieve.resolver&&this.success(null===(w=e.data)||void 0===w?void 0:w.intent),"onRetrieveIntentError"===(null===(f=e.data)||void 0===f?void 0:f.code)&&(this.fail(null===(y=e.data)||void 0===y?void 0:y.error),this.retrieve.awaiting=!1),"onPaymentMethodCreated"===(null===(g=e.data)||void 0===g?void 0:g.code)&&this.createMethod.resolver&&(this.createMethod.resolver(null===(b=e.data)||void 0===b?void 0:b.paymentMethod),this.createMethod.awaiting=!1),"onPaymentMethodCreatedError"===(null===(C=e.data)||void 0===C?void 0:C.code)&&this.fail(null===(E=e.data)||void 0===E?void 0:E.error),["onFocus","onBlur","onChange"].includes(null===(I=e.data)||void 0===I?void 0:I.code)){const t=new CustomEvent(null===($=e.data)||void 0===$?void 0:$.code,{detail:{type:"cardNumber",complete:null!==(x=null===(U=e.data)||void 0===U?void 0:U.complete)&&void 0!==x&&x,empty:null!==(S=null===(A=e.data)||void 0===A?void 0:A.empty)&&void 0!==S&&S,error:null===(R=e.data)||void 0===R?void 0:R.error,brand:null!==(M=null===(j=e.data)||void 0===j?void 0:j.brand)&&void 0!==M?M:""},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}}))}async confirm(e){var t,i,o;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:l,intent_id:d,element:a,...r}=e||{},s=n({id:l,env:null===(t=null==L?void 0:L.options)||void 0===t?void 0:t.env});return null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"confirm",data:{...r,id:l||d,deviceId:s}},this.gatewayUrl),new Promise(((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0}))}async createPaymentMethod(e){var t,n;this.createMethod.awaiting&&console.warn("Should waiting previous createPaymentMethod finished before execute new one!");const{element:i,...o}=e||{};return null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage({code:"createPaymentMethod",data:o},this.gatewayUrl),new Promise(((e,t)=>{this.createMethod.resolver=e,this.createMethod.reject=t,this.createMethod.awaiting=!0}))}async createPaymentConsent(e){var t,i,o;this.paymentConsent.awaiting&&console.warn("Should waiting previous createPaymentConsent finished before execute new one!");const{element:l,intent_id:d,...a}=e,r=n({id:d,env:null===(t=null==L?void 0:L.options)||void 0===t?void 0:t.env});return null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"createPaymentConsent",data:{...a,deviceId:r,intent_id:d}},this.gatewayUrl),new Promise(((e,t)=>{this.paymentConsent.resolver=e,this.paymentConsent.reject=t,this.paymentConsent.awaiting=!0}))}async getPaymentIntent(e,t){var n,i;return this.retrieve.awaiting&&console.warn("Should waiting previous getPaymentIntent finished before execute new one!"),null===(i=null===(n=this.iframe)||void 0===n?void 0:n.contentWindow)||void 0===i||i.postMessage({code:"getIntent",data:{id:e,client_secret:t}},this.gatewayUrl),new Promise(((e,t)=>{this.retrieve.resolver=e,this.retrieve.reject=t,this.retrieve.awaiting=!0}))}success(e){this.confirmIntent.awaiting&&this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.retrieve.awaiting&&this.retrieve.resolver&&this.retrieve.resolver(e),this.paymentConsent.awaiting&&this.paymentConsent.resolver&&this.paymentConsent.resolver(c(e)),this.confirmIntent.awaiting=!1,this.retrieve.awaiting=!1,this.paymentConsent.awaiting=!1}fail(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.retrieve.awaiting&&this.retrieve.reject&&this.retrieve.reject(e),this.createMethod.awaiting&&this.createMethod.reject&&this.createMethod.reject(e),this.paymentConsent.awaiting&&this.paymentConsent.reject&&this.paymentConsent.reject(e),this.retrieve={resolver:null,reject:null,awaiting:!1},this.confirmIntent={resolver:null,reject:null,awaiting:!1},this.createMethod={resolver:null,reject:null,awaiting:!1},this.paymentConsent={resolver:null,reject:null,awaiting:!1}}}class h extends i{constructor(e,t){var n,i,o,l,d;super(e,t),null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/expiry?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=L.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=L.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex expiry number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex expiry number element iframe"),this.addResizeListener("expiry"),window.addEventListener("message",(e=>{var t,n,i,o,l,d,a,r;if(e.origin===this.gatewayUrl&&e.isTrusted&&"expiry"===(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)&&["onFocus","onBlur","onChange"].includes(null===(n=e.data)||void 0===n?void 0:n.code)){const t=new CustomEvent(null===(i=e.data)||void 0===i?void 0:i.code,{detail:{type:"expiry",complete:null!==(l=null===(o=e.data)||void 0===o?void 0:o.complete)&&void 0!==l&&l,empty:null!==(a=null===(d=e.data)||void 0===d?void 0:d.empty)&&void 0!==a&&a,error:null===(r=e.data)||void 0===r?void 0:r.error},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}))}}class p extends i{constructor(e,t){var n,i,o,l,d;super(e,t),this.confirmIntent={resolver:null,reject:null,awaiting:!1},null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/cvc?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=L.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=L.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex cvc number element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex cvc number element iframe"),this.addResizeListener("cvc"),window.addEventListener("message",(e=>{var n,i,o,l,d,a,r,u,c,v,m,h,p,w,f,y,g,b,C,E,I,$,U;if(e.origin===this.gatewayUrl&&e.isTrusted&&"cvc"===(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.type)){if("onSubmit"===(null===(i=e.data)||void 0===i?void 0:i.code)){const t=new CustomEvent(null===(o=e.data)||void 0===o?void 0:o.code,{detail:{type:"cvc"},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}if("onDynamicCurrencyConversion"===(null===(l=e.data)||void 0===l?void 0:l.code)){const t=new CustomEvent(null===(d=e.data)||void 0===d?void 0:d.code,{detail:{type:"cvc"},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}if("onReady"===(null===(a=e.data)||void 0===a?void 0:a.code)&&s({type:"cvc",popupWidth:null===(r=null==t?void 0:t.style)||void 0===r?void 0:r.popupWidth,popupHeight:null===(u=null==t?void 0:t.style)||void 0===u?void 0:u.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer}),"onSuccess"===(null===(c=e.data)||void 0===c?void 0:c.code)&&this.confirmIntent.resolver&&this.success(null===(v=e.data)||void 0===v?void 0:v.intent),"onError"===(null===(m=e.data)||void 0===m?void 0:m.code)&&this.confirmIntent.reject&&this.fail(null===(h=e.data)||void 0===h?void 0:h.error),["onFocus","onBlur","onChange"].includes(null===(p=e.data)||void 0===p?void 0:p.code)){const t=new CustomEvent(null===(w=e.data)||void 0===w?void 0:w.code,{detail:{type:"cvc",complete:null!==(y=null===(f=e.data)||void 0===f?void 0:f.complete)&&void 0!==y&&y,empty:null!==(b=null===(g=e.data)||void 0===g?void 0:g.empty)&&void 0!==b&&b,error:null===(C=e.data)||void 0===C?void 0:C.error},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}e.origin===this.gatewayUrl&&e.isTrusted&&"cardNumber"===(null===(E=e.data)||void 0===E?void 0:E.type)&&"onChange"===(null===(I=e.data)||void 0===I?void 0:I.code)&&(null===(U=null===($=this.iframe)||void 0===$?void 0:$.contentWindow)||void 0===U||U.postMessage({code:"update",options:{cvcLength:e.data.cvcLength}},this.gatewayUrl))}))}async confirm(e){var t,i,o;this.confirmIntent.awaiting&&console.warn("Should waiting previous confirm finished before execute new one!");const{id:l,intent_id:d,element:a,...r}=e||{},s=n({id:l,env:null===(t=null==L?void 0:L.options)||void 0===t?void 0:t.env});return null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"confirm",data:{...r,id:l||d,deviceId:s}},this.gatewayUrl),new Promise(((e,t)=>{this.confirmIntent.resolver=e,this.confirmIntent.reject=t,this.confirmIntent.awaiting=!0}))}success(e){this.confirmIntent.resolver&&this.confirmIntent.resolver(e),this.confirmIntent.awaiting=!1}fail(e){this.confirmIntent.awaiting&&this.confirmIntent.reject&&this.confirmIntent.reject(e),this.confirmIntent={resolver:null,reject:null,awaiting:!1}}}class w extends i{constructor(e,t){var i,o,l,d,a,r;super(e,t);const{intent:u}=t||{},c=n({id:null==u?void 0:u.id,env:null===(i=null==L?void 0:L.options)||void 0===i?void 0:i.env});null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/payment-request-button?options=${encodeURIComponent(JSON.stringify({...t,deviceId:c,fonts:null===(l=L.options)||void 0===l?void 0:l.fonts}))}&lang=${null===(d=L.options)||void 0===d?void 0:d.locale}`),null===(a=this.iframe)||void 0===a||a.setAttribute("name","Airwallex payment request element iframe"),null===(r=this.iframe)||void 0===r||r.setAttribute("title","Airwallex payment request element iframe"),this.addResizeListener("paymentRequestButton"),window.addEventListener("message",(e=>{var n,i,o,l,d,a,r,u;e.origin===this.gatewayUrl&&e.isTrusted&&"paymentRequestButton"===(null===(n=e.data)||void 0===n?void 0:n.type)&&("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)?s({type:"paymentRequestButton",popupWidth:null===(o=null==t?void 0:t.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==t?void 0:t.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer}):"onSuccess"===(null===(d=e.data)||void 0===d?void 0:d.code)?this.success(null===(a=e.data)||void 0===a?void 0:a.intent):"onError"===(null===(r=e.data)||void 0===r?void 0:r.code)&&this.fail(null===(u=e.data)||void 0===u?void 0:u.error))}))}success(e){const t=new CustomEvent("onSuccess",{detail:{type:"paymentRequestButton",intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}fail(e){const t=new CustomEvent("onError",{detail:{type:"paymentRequestButton",error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}class f extends i{constructor(e,t){var i,o,l,d,a,r;super(e,t);const{intent:u}=t||{},c=n({id:null==u?void 0:u.id,env:null===(i=null==L?void 0:L.options)||void 0===i?void 0:i.env});null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/dropin?options=${encodeURIComponent(JSON.stringify({...t,deviceId:c,fonts:null===(l=L.options)||void 0===l?void 0:l.fonts}))}&lang=${null===(d=L.options)||void 0===d?void 0:d.locale}`),null===(a=this.iframe)||void 0===a||a.setAttribute("name","Airwallex dropIn element iframe"),null===(r=this.iframe)||void 0===r||r.setAttribute("title","Airwallex dropIn element iframe"),this.addResizeListener("dropIn"),window.addEventListener("message",(e=>{var n,i,o,l,d,a,r,u,c,v,m;if(e.origin===this.gatewayUrl&&e.isTrusted&&"dropIn"===(null===(n=e.data)||void 0===n?void 0:n.type))if("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)&&s({type:"dropIn",popupWidth:null===(o=null==t?void 0:t.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==t?void 0:t.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer}),"onRedirect"===(null===(d=e.data)||void 0===d?void 0:d.code)){const{redirectUrl:t}=null!==(r=null===(a=e.data)||void 0===a?void 0:a.redirectPayload)&&void 0!==r?r:{};window.location.href=t}else"onSuccess"===(null===(u=e.data)||void 0===u?void 0:u.code)?this.success(null===(c=e.data)||void 0===c?void 0:c.intent):"onError"===(null===(v=e.data)||void 0===v?void 0:v.code)&&this.fail(null===(m=e.data)||void 0===m?void 0:m.error)}))}success(e){const t=new CustomEvent("onSuccess",{detail:{type:"dropIn",intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}fail(e){const t=new CustomEvent("onError",{detail:{type:"dropIn",error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}const y="fullFeaturedCard";class g extends i{constructor(e,t){var i,o,l,d,a,r;super(e,t);const{intent:u}=t||{},c=n({id:null==u?void 0:u.id,env:null===(i=null==L?void 0:L.options)||void 0===i?void 0:i.env});null===(o=this.iframe)||void 0===o||o.setAttribute("src",`${e}/#/elements/full-featured-card?options=${encodeURIComponent(JSON.stringify({...t,deviceId:c,fonts:null===(l=L.options)||void 0===l?void 0:l.fonts}))}&lang=${null===(d=L.options)||void 0===d?void 0:d.locale}`),null===(a=this.iframe)||void 0===a||a.setAttribute("name","Airwallex full featured card element iframe"),null===(r=this.iframe)||void 0===r||r.setAttribute("title","Airwallex full featured card element iframe"),this.addResizeListener(y),window.addEventListener("message",(e=>{var n,i,o,l,d,a,r,u;e.origin===this.gatewayUrl&&e.isTrusted&&(null===(n=e.data)||void 0===n?void 0:n.type)===y&&("onReady"===(null===(i=e.data)||void 0===i?void 0:i.code)?s({type:y,popupWidth:null===(o=null==t?void 0:t.style)||void 0===o?void 0:o.popupWidth,popupHeight:null===(l=null==t?void 0:t.style)||void 0===l?void 0:l.popupHeight,authFormContainer:null==t?void 0:t.authFormContainer}):"onSuccess"===(null===(d=e.data)||void 0===d?void 0:d.code)?this.success(null===(a=e.data)||void 0===a?void 0:a.intent):"onError"===(null===(r=e.data)||void 0===r?void 0:r.code)&&this.fail(null===(u=e.data)||void 0===u?void 0:u.error))}))}update(e){var t,i,o;this.options={...this.options,...e};const{intent:l}=this.options||{},d=n({id:null==l?void 0:l.id,env:null===(t=null==L?void 0:L.options)||void 0===t?void 0:t.env});null===(o=null===(i=this.iframe)||void 0===i?void 0:i.contentWindow)||void 0===o||o.postMessage({code:"update",options:{...e,deviceId:d}},this.gatewayUrl)}success(e){const t=new CustomEvent("onSuccess",{detail:{type:y,intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}fail(e){const t=new CustomEvent("onError",{detail:{type:y,error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}class b extends i{constructor(e,t){var n,i,o,l,d;super(e,t),null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/wechat?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=L.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=L.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex wechat element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex wechat element iframe"),this.addResizeListener("wechat"),window.addEventListener("message",(e=>{var t,n,i,o,l,d;e.origin===this.gatewayUrl&&e.isTrusted&&"wechat"===(null===(t=e.data)||void 0===t?void 0:t.type)&&("onRedirect"===(null===(n=e.data)||void 0===n?void 0:n.code)?window.location.href=null===(i=e.data)||void 0===i?void 0:i.redirectUrl:"onSuccess"===(null===(o=e.data)||void 0===o?void 0:o.code)?this.success(null===(l=e.data)||void 0===l?void 0:l.intent):"onError"===(null===(d=e.data)||void 0===d?void 0:d.code)&&this.fail(e.data.error))}))}success(e){const t=new CustomEvent("onSuccess",{detail:{type:"wechat",intent:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}fail(e){const t=new CustomEvent("onError",{detail:{type:"wechat",error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}class C extends i{constructor(e,t){var n,i,o,l,d;super(e,t),null===(n=this.iframe)||void 0===n||n.setAttribute("src",`${e}/#/elements/redirect?options=${encodeURIComponent(JSON.stringify({...this.options,fonts:null===(i=L.options)||void 0===i?void 0:i.fonts}))}&lang=${null===(o=L.options)||void 0===o?void 0:o.locale}`),null===(l=this.iframe)||void 0===l||l.setAttribute("name","Airwallex redirect element iframe"),null===(d=this.iframe)||void 0===d||d.setAttribute("title","Airwallex redirect element iframe"),this.addResizeListener("redirect"),window.addEventListener("message",(e=>{var n,i,o,l,d;if(e.origin===this.gatewayUrl&&e.isTrusted&&"redirect"===(null===(n=e.data)||void 0===n?void 0:n.type))if("onRedirect"===(null===(i=e.data)||void 0===i?void 0:i.code)){const{redirectUrl:n,method:i}=null!==(l=null===(o=e.data)||void 0===o?void 0:o.redirectPayload)&&void 0!==l?l:{};i===(null==t?void 0:t.method)&&(window.location.href=n)}else"onError"===(null===(d=e.data)||void 0===d?void 0:d.code)&&this.fail(e.data.error)}))}fail(e){const t=new CustomEvent("onError",{detail:{type:"redirect",error:e},bubbles:!0,composed:!0});window.document.dispatchEvent(t)}}const E=e=>e.startsWith("http://")||e.startsWith("https://")?encodeURIComponent(e):encodeURIComponent(`https://${e}`),I=/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/,$=e=>"string"==typeof e,U=e=>"boolean"==typeof e,x=e=>"string"==typeof e&&I.test(e),A={id:{validate:$,format:e=>`${e}`},client_secret:{validate:$,format:e=>`${e}`},theme:{validate:e=>"object"==typeof e,format:e=>JSON.stringify(e)},customer_id:{validate:$,format:e=>`${e}`},components:{validate:e=>"object"==typeof e,format:e=>JSON.stringify(e)},autoCapture:{validate:U,format:e=>`${e}`},successUrl:{validate:x,format:e=>E(`${e}`)},failUrl:{validate:x,format:e=>E(`${e}`)},cancelUrl:{validate:x,format:e=>E(`${e}`)},logoUrl:{validate:x,format:e=>E(`${e}`)},locale:{validate:$,format:e=>`${e}`},withBilling:{validate:U,format:e=>`${e}`}},S={prod:"checkout.airwallex.com",demo:"checkout-demo.airwallex.com",staging:"checkout-staging.airwallex.com",qa:"checkoutui.qa.awx.im",preview:"checkoutui.preview.awx.im",dev:"localhost:3000"},R=e=>`https://${S[e]||"checkout.airwallex.com"}`,j=["cardNumber","expiry","cvc","paymentRequestButton","card","wechat","redirect","dropIn","fullFeaturedCard"],M=[...j,"threeDsFrictionless","threeDsChallenge"],L={gatewayUrl:"",options:{}},W={cardNumber:null,expiry:null,cvc:null,threeDsFrictionless:null,threeDsChallenge:null,paymentRequestButton:null,card:null,wechat:null,redirect:null,dropIn:null,fullFeaturedCard:null},_=e=>{var t;return M.includes(e)?(null===(t=W[e])||void 0===t||t.destroy(),W[e]=null,!0):(console.warn(`destroyElement with type: ${e} not support!`),!1)},P=e=>M.includes(e)?W[e]:(console.warn(`getElement with type: ${e} not support!`),null),D=(e,t)=>M.includes(e)?(W[e]=t,!0):(console.warn(`destroyElement with type: ${e} not support!`),!1);return e.confirmPaymentIntent=async e=>(console.info(`Confirm intent ${(null==e?void 0:e.intent_id)||(null==e?void 0:e.id)} with client secret: ${null==e?void 0:e.client_secret}`),(null==e?void 0:e.element)?(null==e?void 0:e.element).confirm(e):(console.warn("Card number element must be provided for card payment confirm!"),!1)),e.confirmPaymentIntentWithSavedCard=async e=>(console.info(`Confirm intent ${(null==e?void 0:e.intent_id)||(null==e?void 0:e.id)} with client secret: ${null==e?void 0:e.client_secret}`),(null==e?void 0:e.element)&&(null==e?void 0:e.methodId)?(null==e?void 0:e.element).confirm(e):(console.warn("Payment method id must be provided for cvc payment confirm!"),!1)),e.createElement=(e,t)=>{var n;const i=null!=t?t:{origin:""};return i.origin||(i.origin=null===(n=L.options)||void 0===n?void 0:n.origin),j.includes(e)?"cardNumber"===e?(W[e]=new m(L.gatewayUrl,i),W[e]):"card"===e?(W[e]=new v(L.gatewayUrl,i),W[e]):"fullFeaturedCard"===e?(W[e]=new g(L.gatewayUrl,i),W[e]):"wechat"===e?(W[e]=new b(L.gatewayUrl,i),W[e]):"redirect"===e?(W[e]=new C(L.gatewayUrl,i),W[e]):"paymentRequestButton"===e?(W[e]=new w(L.gatewayUrl,i),W[e]):"dropIn"===e?(W[e]=new f(L.gatewayUrl,i),W[e]):"expiry"===e||"cvc"===e?(W[e]="expiry"===e?new h(L.gatewayUrl,i):new p(L.gatewayUrl,i),window.addEventListener("message",(t=>{var n,i,o,l,d,a;t.origin===L.gatewayUrl&&t.isTrusted&&e===(null===(n=t.data)||void 0===n?void 0:n.type)&&"onChange"===(null===(i=t.data)||void 0===i?void 0:i.code)&&(null===(d=null===(l=null===(o=W.cardNumber)||void 0===o?void 0:o.iframe)||void 0===l?void 0:l.contentWindow)||void 0===d||d.postMessage({code:`update_${null===(a=t.data)||void 0===a?void 0:a.type}`,data:t.data},L.gatewayUrl))})),W[e]):null:(console.warn(`createElement with type: ${e} not support!`),null)},e.createPaymentConsent=async e=>(console.info(`Create payment consent with client secret: ${e.client_secret}`),(null==e?void 0:e.element)?(null==e?void 0:e.element).createPaymentConsent(e):(console.warn("Either payment method id or element must be provided for create payment consent!"),!1)),e.createPaymentMethod=async(e,t)=>(console.info(`Create payment method with client secret: ${e}`),(null==t?void 0:t.element)?(null==t?void 0:t.element).createPaymentMethod({...t,client_secret:e}):(console.warn("Either payment method id or element must be provided for payment method create!"),!1)),e.destroyElement=_,e.getElement=P,e.getPaymentIntent=async(e,t)=>{var n;return(null===(n=W.cardNumber)||void 0===n?void 0:n.getPaymentIntent(e,t))||!1},e.handle3dsFlow=s,e.init=e=>{!(null==e?void 0:e.env)&&L.gatewayUrl||(L.gatewayUrl=R((null==e?void 0:e.env)||"prod")),L.options=e},e.redirectToCheckout=e=>{const{env:t,...n}=e,i=(e=>{const t={};return Object.keys(A).forEach((n=>{const i=e[n];i&&A[n].validate(i)&&(t[n]=A[n].format(i))})),t})(n),{id:o,...l}=i||{},d=Object.keys(l),a=[];d.forEach((e=>{a.push(`${e}=${l[e]}`)}));const r=`${R(t||"prod")}/#/standalone/checkout/${o}?${a.join("&")}`;window.location.href=r},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
/* Airwallex @Charlie.Lang */